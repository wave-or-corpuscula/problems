# https://leetcode.com/problems/minimum-pair-removal-to-sort-array-i/description/?envType=daily-question&envId=2026-01-22

from typing import List


class Solution:
    def minimumPairRemoval(self, nums: List[int]) -> int:
        def min_pair_sum(nums: List[int]) -> tuple[List[int], bool]:
            non_decr = True
            min_pair = 10**10
            first = -1
            for i in range(len(nums) - 1):
                pair_sum = nums[i] + nums[i + 1]
                if pair_sum < min_pair:
                    min_pair = pair_sum
                    first = i
                if non_decr and nums[i] > nums[i + 1]:
                    non_decr = False
            if not non_decr:
                nums[first] = nums[first] + nums[first + 1]
                nums.pop(first + 1)

            return nums, non_decr

        op_num = 0
        while True:
            nums, non_decr = min_pair_sum(nums)
            if non_decr:
                break
            op_num += 1
        return op_num
        




if __name__ == "__main__":
    sol = Solution()
    tests = [
        [172955385,254605007,-309046561,555574923,-369682057,62667808,-369753636,-337875158,259320172,555027127,619029810,-477954639,-368174982,-792634361,463753214,734911340,28356954,442174885,735655539,-216199887,-252938497,-137017699,170274330,337078861,184675543,-438526610,308025194,627657141,443260654,-744350977,-266665168,-314640186,-452613802,-6211405,643614165,118401449,102179446,-785425128,179100501,-456218164,-414667854,258476602,-470684998,273210827,-500884612,224275396,299838715,761056172,173205018,180895702,-558870793,-434294811,-382221763,745951550,177201083,-184441060,126146290,-95979024,785419113,-495587613,143857513,-266387913,625358422,-32684633,596360898,-501823826,-232356322,-654156910,-27386146,662673493,-141464055,4746558,-593593086,643951967,-723607552,-81294356,178074267,511558898,-779442015,-554589320,503657871,-224493501,-339528114,357473940,-488649432,309863824,351724079,547568724,-680608918,219018598,-369954253,585527211,97608137,17332320,75781606,-195991591,2725542,-555064569,401405712,447460803,-627476713,58497350,514477616,205802932,651417386,-221373315,250527532,350833519,-692987332,265925230,-132634916,-64486303,390816365,457968365,774090447,-721181844,650833403,-227754249,138830419,547895245,-528679498,-517087136,-247725742,339692970,-715724355,65812346,65687837,-446623722,74324996,-480728834,-317550701,568132410,-286048847,-486187167,-792932228,-372417335,486095205,-191576038,733388289,-724610140,118755779,622671529,19368897,145238293,-269217093,376819722,508260128,-542819123,678325147,559850164,117614751,501778798,-509168462,-603469199,-712424021,28675326,-181655190,-767542277,-495655920,325712567,460498189,252585004,701215005,769961512,220650399,426121042,766836116,520332834,-553827973,-599148500,607136906,-792811383,-724134439,255086115,336998363,31348225,-431166953,-632058597,-654530906,-55587705,-288025739,270117086,-576707669,247265748,173499523,126467614,775671372,-412028725,-493679278,98619726,552986107,-283616942,791529989,-554551180,-234182250,-608718499,753539883,725951342,715771296,340168597,-378589584,148318185,140908557,-412851988,75740516,-198575906,32562672,-656678291,395515592,-71561678,-393586731,448964771,-80651176,163745074,-425630634,303477536,-312178475,-760405230,-470281653,-183680491,-165415297,-551071661,-786183431,-356233158,654507289,-704097419,15932776,709612731,-182326838,170695973,-83365457,687113131,735860840,-40632944,-292876902,420646979,400669210,-673134907,717665582,-117685320,-384621367,777935570,655771742,-759163163,-499572239,461684252,61832869,-64080150,-260636240,538656759,-272112699,190492953,699869702,-203596852,134436661,-107162647,-644714807,623448201,120280916,486306236,43614266,192603811,-723765513,-78116136,361935380,403354904,-4347486,394090154,758841146,602664979,688037408,-611456021,-138533183,-677254689,565493241,-296211786,-11128778,-10846678,-251099084,-763755085,37764413,-361761072,563417597,650946784,530716555,330582912,-16183631,49584173,-310447453,-616419045,-433369587,450938247,183314878,-712766168,-410582916,-504154874,706630130,151866331,137974812,536190716],
        # [5,2,3,1],
        # [1,2,2],
    ]

    for nums in tests:
        res = sol.minimumPairRemoval(nums)
        print(res)